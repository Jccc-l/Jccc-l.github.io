<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"jccc-l.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"hide","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="æ—å­é›¨è€å¸ˆçš„ç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†ææ¡ˆä¾‹çš„å¤ç°è®°å½•">
<meta property="og:type" content="article">
<meta property="og:title" content="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ">
<meta property="og:url" content="https://jccc-l.github.io/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-6%E2%80%94%E2%80%94%E5%AE%9E%E9%AA%8C%E6%A1%88%E4%BE%8B%EF%BC%9A%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="ç’æ¿„ã®Î²lÃ²É¡">
<meta property="og:description" content="æ—å­é›¨è€å¸ˆçš„ç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†ææ¡ˆä¾‹çš„å¤ç°è®°å½•">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-06-16T08:31:29.000Z">
<meta property="article:modified_time" content="2024-11-13T03:19:05.409Z">
<meta property="article:author" content="Jccc">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Big Data">
<meta property="article:tag" content="Hadoop">
<meta property="article:tag" content="ZooKeeper">
<meta property="article:tag" content="HBase">
<meta property="article:tag" content="R">
<meta property="article:tag" content="Hive">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jccc-l.github.io/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-6%E2%80%94%E2%80%94%E5%AE%9E%E9%AA%8C%E6%A1%88%E4%BE%8B%EF%BC%9A%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://jccc-l.github.io/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-6%E2%80%94%E2%80%94%E5%AE%9E%E9%AA%8C%E6%A1%88%E4%BE%8B%EF%BC%9A%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/","path":"2024/06/16/å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—-No-6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ/","title":"å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ | ç’æ¿„ã®Î²lÃ²É¡</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ç’æ¿„ã®Î²lÃ²É¡</p>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="https://static.wixstatic.com/media/7ac599_2e792bfa812140c898f6c3a78e4ab78f~mv2.png/v1/fill/w_951,h_1046,al_c,q_90,usm_0.66_1.00_0.01,enc_auto/7ac599_2e792bfa812140c898f6c3a78e4ab78f~mv2.png" alt="ç’æ¿„ã®Î²lÃ²É¡">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="æœç´¢..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97_no6%E5%AE%9E%E9%AA%8C%E6%A1%88%E4%BE%8B%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90"><span class="nav-text"> å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text"> å®éªŒç¯å¢ƒæ­å»º</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8A%E4%BC%A0%E5%88%B0%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93hive"><span class="nav-text"> æœ¬åœ°æ•°æ®é›†ä¸Šä¼ åˆ°æ•°æ®ä»“åº“Hive</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E4%B8%8B%E8%BD%BD"><span class="nav-text"> å®éªŒæ•°æ®é›†çš„ä¸‹è½½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-text"> æ•°æ®é›†çš„é¢„å¤„ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text"> å¯¼å…¥æ•°æ®åº“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hive%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="nav-text"> Hiveæ•°æ®åˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90"><span class="nav-text"> ç®€å•æŸ¥è¯¢åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%9D%A1%E6%95%B0%E7%BB%9F%E8%AE%A1"><span class="nav-text"> æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90"><span class="nav-text"> å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90"><span class="nav-text"> æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E5%AE%9E%E6%97%B6%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90"><span class="nav-text"> ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hive-mysql-hbase%E6%95%B0%E6%8D%AE%E4%BA%92%E5%AF%BC"><span class="nav-text"> Hiveã€MySQLã€HBaseæ•°æ®äº’å¯¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#hive%E9%A2%84%E6%93%8D%E4%BD%9C"><span class="nav-text"> Hiveé¢„æ“ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8java-api%E5%B0%86%E6%95%B0%E6%8D%AE%E4%BB%8Ehive%E5%AF%BC%E5%85%A5mysql"><span class="nav-text"> ä½¿ç”¨Java APIå°†æ•°æ®ä»Hiveå¯¼å…¥MySQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8hbase-java-api%E6%8A%8A%E6%95%B0%E6%8D%AE%E4%BB%8E%E6%9C%AC%E5%9C%B0%E5%AF%BC%E5%85%A5%E5%88%B0hbase%E4%B8%AD"><span class="nav-text"> ä½¿ç”¨HBase Java APIæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°HBaseä¸­</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jccc"
      src="https://static.wixstatic.com/media/7ac599_2e792bfa812140c898f6c3a78e4ab78f~mv2.png/v1/fill/w_951,h_1046,al_c,q_90,usm_0.66_1.00_0.01,enc_auto/7ac599_2e792bfa812140c898f6c3a78e4ab78f~mv2.png">
  <p class="site-author-name" itemprop="name">Jccc</p>
  <div class="site-description" itemprop="description">Jcccçš„èƒ¡è¨€ä¹±è¯­</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">48</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Jccc-l" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Jccc-l" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1216550215Jc@gmail.com" title="E-Mail â†’ mailto:1216550215Jc@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://huggingface.co/Jccc-l" title="ğŸ¤— Hg Face â†’ https:&#x2F;&#x2F;huggingface.co&#x2F;Jccc-l" rel="noopener me" target="_blank">ğŸ¤— Hg Face</a>
      </span>
      <span class="links-of-author-item">
        <a href="/contact/WeChat" title="WeChat â†’ &#x2F;contact&#x2F;WeChat" rel="noopener me"><i class="fab fa-weixin fa-fw"></i>WeChat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://qm.qq.com/q/ZOA0HXIwU0" title="QQ â†’ https:&#x2F;&#x2F;qm.qq.com&#x2F;q&#x2F;ZOA0HXIwU0" rel="noopener me" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          é“¾æ¥
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://julintongxue.github.io/" title="https:&#x2F;&#x2F;julintongxue.github.io" rel="noopener" target="_blank">orangeã®åšå®¢</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://georgenhj.github.io/" title="https:&#x2F;&#x2F;georgenhj.github.io&#x2F;" rel="noopener" target="_blank">George Nong's Blog</a>
            </li>
        </ul>
      </div>
    </div>
    <embed id="musicplayer" frameborder="no" border="0" marginwidth="0" marginheight="0" width=400 height=86 src="//music.163.com/outchain/player?type=2&id=407450660&auto=1&height=66"></embed>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jccc-l.github.io/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-6%E2%80%94%E2%80%94%E5%AE%9E%E9%AA%8C%E6%A1%88%E4%BE%8B%EF%BC%9A%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://static.wixstatic.com/media/7ac599_2e792bfa812140c898f6c3a78e4ab78f~mv2.png/v1/fill/w_951,h_1046,al_c,q_90,usm_0.66_1.00_0.01,enc_auto/7ac599_2e792bfa812140c898f6c3a78e4ab78f~mv2.png">
      <meta itemprop="name" content="Jccc">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç’æ¿„ã®Î²lÃ²É¡">
      <meta itemprop="description" content="Jcccçš„èƒ¡è¨€ä¹±è¯­">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ | ç’æ¿„ã®Î²lÃ²É¡">
      <meta itemprop="description" content="æ—å­é›¨è€å¸ˆçš„ç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†ææ¡ˆä¾‹çš„å¤ç°è®°å½•">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2024-06-16 16:31:29" itemprop="dateCreated datePublished" datetime="2024-06-16T16:31:29+08:00">2024-06-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-11-13 11:19:05" itemprop="dateModified" datetime="2024-11-13T11:19:05+08:00">2024-11-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Big-Data/" itemprop="url" rel="index"><span itemprop="name">Big Data</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>38k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>35 åˆ†é’Ÿ</span>
    </span>
</div>

            <div class="post-description">æ—å­é›¨è€å¸ˆçš„ç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†ææ¡ˆä¾‹çš„å¤ç°è®°å½•</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_no6å®éªŒæ¡ˆä¾‹ç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ"><a class="markdownIt-Anchor" href="#å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_no6å®éªŒæ¡ˆä¾‹ç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ"></a> å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ</h1>
<h2 id="å®éªŒç¯å¢ƒæ­å»º"><a class="markdownIt-Anchor" href="#å®éªŒç¯å¢ƒæ­å»º"></a> å®éªŒç¯å¢ƒæ­å»º</h2>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œéœ€è¦ç”¨åˆ°ä¸‹åˆ—è½¯ä»¶åŒ…ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„è½¯ä»¶ç‰ˆæœ¬ï¼Œç‚¹å‡»å³å¯è·³è½¬åˆ°å®˜ç½‘æˆ–å›½å†…é•œåƒç«™çš„ä¸‹è½½é“¾æ¥ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/22.04/ubuntu-22.04.4-desktop-amd64.iso">Linux</a>: Ubuntu 22.04.4 LTS</li>
<li><a target="_blank" rel="noopener" href="https://dlcdn.apache.org/hadoop/common/hadoop-3.3.6/hadoop-3.3.6.tar.gz">Hadoop</a>: 3.3.6</li>
<li><a target="_blank" rel="noopener" href="https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz">Hive</a>: 3.1.3</li>
<li><a target="_blank" rel="noopener" href="https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz">ZooKeeper</a>: 3.9.2</li>
<li><a target="_blank" rel="noopener" href="https://cran.r-project.org/index.html">R</a>æœ‰ä¸¤ç§å®‰è£…æ–¹å¼ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼ŒäºŒé€‰ä¸€å³å¯
<ul>
<li><a target="_blank" rel="noopener" href="https://cran.r-project.org/bin/linux/ubuntu/">Ubuntu Packages For R - Brief Instructions</a></li>
<li><a target="_blank" rel="noopener" href="https://cran.r-project.org/bin/linux/ubuntu/fullREADME.html">Ubuntu Packages For R - Full Instructions</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.apache.org/dyn/closer.lua/hbase/2.5.8/hbase-2.5.8-hadoop3-bin.tar.gz">HBase</a>: 2.5.8-hadoop3-bin</li>
<li><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/installation-guide.html">JetBrains IntelliJ IDEA</a>
<ul>
<li>ä½¿ç”¨Linuxç‰ˆæœ¬çš„Standalone installationå•ç‹¬ä¸‹è½½IDEA</li>
</ul>
</li>
</ul>
<p>è¯·æ ¹æ®å‰é¢çš„æ•™ç¨‹å®‰è£…é…ç½®å¥½è¿™äº›è½¯ä»¶</p>
<ul>
<li>
<a href="/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-1%E2%80%94%E2%80%94Hadoop%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.1â€”â€”Hadoopçš„å®‰è£…é…ç½®">å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.1â€”â€”Hadoopçš„å®‰è£…é…ç½®</a>
</li>
<li>
<a href="/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-2%E2%80%94%E2%80%94Hive%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.2â€”â€”Hiveçš„å®‰è£…é…ç½®">å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.2â€”â€”Hiveçš„å®‰è£…é…ç½®</a>
</li>
<li>
<a href="/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-3%E2%80%94%E2%80%94ZooKeeper%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.3â€”â€”ZooKeeperçš„å®‰è£…é…ç½®.md">å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.3â€”â€”ZooKeeperçš„å®‰è£…é…ç½®.md</a>
</li>
<li>
<a href="/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-4%E2%80%94%E2%80%94HBase%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.4â€”â€”HBaseçš„å®‰è£…é…ç½®.md">å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.4â€”â€”HBaseçš„å®‰è£…é…ç½®.md</a>
</li>
<li>
<a href="/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-5%E2%80%94%E2%80%94R%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%9A%84%E5%AE%89%E8%A3%85/" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.5â€”â€”Rè¯­è¨€å’Œè½¯ä»¶åŒ…çš„å®‰è£…">å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.5â€”â€”Rè¯­è¨€å’Œè½¯ä»¶åŒ…çš„å®‰è£…</a>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://dblab.xmu.edu.cn/blog/4189/">æ—å­é›¨è€å¸ˆçš„æ•™ç¨‹</a></p>
<p>IDEå¯ä»¥è‡ªé€‰IntelliJ IDEA<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>æˆ–Eclipse<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p>
<h2 id="æœ¬åœ°æ•°æ®é›†ä¸Šä¼ åˆ°æ•°æ®ä»“åº“hive"><a class="markdownIt-Anchor" href="#æœ¬åœ°æ•°æ®é›†ä¸Šä¼ åˆ°æ•°æ®ä»“åº“hive"></a> æœ¬åœ°æ•°æ®é›†ä¸Šä¼ åˆ°æ•°æ®ä»“åº“Hive</h2>
<h3 id="å®éªŒæ•°æ®é›†çš„ä¸‹è½½"><a class="markdownIt-Anchor" href="#å®éªŒæ•°æ®é›†çš„ä¸‹è½½"></a> å®éªŒæ•°æ®é›†çš„ä¸‹è½½</h3>
<ul>
<li>æœ¬æ¡ˆä¾‹é‡‡ç”¨çš„æ•°æ®é›†ä¸º<code>user.zip</code>ï¼ŒåŒ…å«äº†ä¸€ä¸ªå¤§è§„æ¨¡æ•°æ®é›†<code>raw_user.csv</code>ï¼ˆåŒ…å«2000ä¸‡æ¡è®°å½•ï¼‰ï¼Œå’Œä¸€ä¸ªå°æ•°æ®é›†<code>small_user.csv</code>ï¼ˆåªåŒ…å«30ä¸‡æ¡è®°å½•ï¼‰ã€‚å°æ•°æ®é›†<code>small_user.csv</code>æ˜¯ä»å¤§è§„æ¨¡æ•°æ®é›†<code>raw_user.csv</code>ä¸­æŠ½å–çš„ä¸€å°éƒ¨åˆ†æ•°æ®ã€‚ä¹‹æ‰€ä»¥æŠ½å–å‡ºä¸€å°‘éƒ¨åˆ†è®°å½•å•ç‹¬æ„æˆä¸€ä¸ªå°æ•°æ®é›†ï¼Œæ˜¯å› ä¸ºåœ¨ç¬¬ä¸€éè·‘é€šæ•´ä¸ªå®éªŒæµç¨‹æ—¶ï¼Œä¼šé‡åˆ°å„ç§é”™è¯¯ã€å„ç§é—®é¢˜ï¼Œå…ˆç”¨å°æ•°æ®é›†æµ‹è¯•ï¼Œå¯ä»¥å¤§é‡èŠ‚çº¦ç¨‹åºè¿è¡Œæ—¶é—´ã€‚ç­‰åˆ°ç¬¬ä¸€æ¬¡å®Œæ•´å®éªŒæµç¨‹éƒ½é¡ºåˆ©è·‘é€šä»¥åï¼Œå¯ä»¥æœ€åç”¨å¤§è§„æ¨¡æ•°æ®é›†è¿›è¡Œæœ€åçš„æµ‹è¯•ã€‚</li>
<li>æŠŠæ•°æ®é›†<code>user.zip</code>æ–‡ä»¶ä¸‹è½½åˆ°Linuxç³»ç»Ÿçš„<code>/home/hadoop/Downloads/</code>ç›®å½•ä¸‹é¢</li>
</ul>
<p>ä¸‹è½½æ¡ˆä¾‹çš„æ•°æ®é›†<code>user.zip</code>åˆ°ç›®å½•<code>/home/hadoop/Downloads/</code>å†…ï¼ˆç³»ç»Ÿè¯­è¨€å¦‚æœæ˜¯ä¸­æ–‡ï¼Œåˆ™æ˜¯`/home/hadoop/ä¸‹è½½ï¼‰</p>
<p>åˆ›å»ºä¸€ä¸ªå­˜å‚¨æ•°æ®é›†çš„ç›®å½•ï¼Œå°†<code>user.zip</code>è¿›è¡Œè§£å‹ç¼©</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /usr/local/bigdatacase/dataset</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> -R hadoop:hadoop /usr/local/bigdatacase <span class="comment"># ä¿®æ”¹bigdatacaseç›®å½•æƒé™</span></span><br><span class="line">unzip /home/hadoop/Downloads/user.zip -d /usr/local/bigdatacase/dataset <span class="comment"># è§£å‹ç¼©æ•°æ®æ–‡ä»¶user.zip</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/bigdatacase/dataset</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¯ä»¥çœ‹åˆ°<code>dataset</code>ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š<code>raw_user.csv</code>å’Œ<code>small_user.csv</code>ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å‰5æ¡æ•°æ®</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">head</span> -5 raw_user.csv</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®é›†çš„é¢„å¤„ç†"><a class="markdownIt-Anchor" href="#æ•°æ®é›†çš„é¢„å¤„ç†"></a> æ•°æ®é›†çš„é¢„å¤„ç†</h3>
<p>åˆ é™¤æ–‡ä»¶çš„ç¬¬ä¸€è¡Œè®°å½•ï¼ˆå­—æ®µåç§°ï¼‰</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;1d&#x27;</span> raw_user.csv</span><br><span class="line">sed -i <span class="string">&#x27;1d&#x27;</span> small_user.csv</span><br><span class="line"><span class="built_in">head</span> -5 raw_user.csv</span><br><span class="line"><span class="built_in">head</span> -5 small_user.csv</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹åˆ°å·²ç»çœ‹ä¸åˆ°å­—æ®µåæˆè¿™ä¸€è¡Œ</p>
<p>å¯¹å­—æ®µè¿›è¡Œé¢„å¤„ç†</p>
<p>ä¸‹é¢è¦å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶<code>pre_deal.sh</code>ï¼Œè¯·æŠŠè¿™ä¸ªè„šæœ¬æ–‡ä»¶æ”¾åœ¨<code>dataset</code>ç›®å½•ä¸‹ï¼Œå’Œæ•°æ®é›†<code>raw_user.csv</code>æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼š</p>
<figure class="highlight sh"><figcaption><span>/usr/local/bigdatacase/dataset/pre_deal.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#ä¸‹é¢è®¾ç½®è¾“å…¥æ–‡ä»¶ï¼ŒæŠŠç”¨æˆ·æ‰§è¡Œpre_deal.shå‘½ä»¤æ—¶æä¾›çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥æ–‡ä»¶åç§°</span></span><br><span class="line">infile=<span class="variable">$1</span></span><br><span class="line"><span class="comment">#ä¸‹é¢è®¾ç½®è¾“å‡ºæ–‡ä»¶ï¼ŒæŠŠç”¨æˆ·æ‰§è¡Œpre_deal.shå‘½ä»¤æ—¶æä¾›çš„ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºè¾“å‡ºæ–‡ä»¶åç§°</span></span><br><span class="line">outfile=<span class="variable">$2</span></span><br><span class="line"><span class="comment">#æ³¨æ„ï¼Œæœ€åçš„$infile&gt; $outfileå¿…é¡»è·Ÿåœ¨&#125;â€™è¿™ä¸¤ä¸ªå­—ç¬¦çš„åé¢</span></span><br><span class="line">awk -F <span class="string">&quot;,&quot;</span> <span class="string">&#x27;BEGIN&#123;</span></span><br><span class="line"><span class="string">srand();</span></span><br><span class="line"><span class="string">        id=0;</span></span><br><span class="line"><span class="string">        Province[0]=&quot;å±±ä¸œ&quot;;Province[1]=&quot;å±±è¥¿&quot;;Province[2]=&quot;æ²³å—&quot;;Province[3]=&quot;æ²³åŒ—&quot;;Province[4]=&quot;é™•è¥¿&quot;;Province[5]=&quot;å†…è’™å¤&quot;;Province[6]=&quot;ä¸Šæµ·å¸‚&quot;;</span></span><br><span class="line"><span class="string">        Province[7]=&quot;åŒ—äº¬å¸‚&quot;;Province[8]=&quot;é‡åº†å¸‚&quot;;Province[9]=&quot;å¤©æ´¥å¸‚&quot;;Province[10]=&quot;ç¦å»º&quot;;Province[11]=&quot;å¹¿ä¸œ&quot;;Province[12]=&quot;å¹¿è¥¿&quot;;Province[13]=&quot;äº‘å—&quot;; </span></span><br><span class="line"><span class="string">        Province[14]=&quot;æµ™æ±Ÿ&quot;;Province[15]=&quot;è´µå·&quot;;Province[16]=&quot;æ–°ç–†&quot;;Province[17]=&quot;è¥¿è—&quot;;Province[18]=&quot;æ±Ÿè¥¿&quot;;Province[19]=&quot;æ¹–å—&quot;;Province[20]=&quot;æ¹–åŒ—&quot;;</span></span><br><span class="line"><span class="string">        Province[21]=&quot;é»‘é¾™æ±Ÿ&quot;;Province[22]=&quot;å‰æ—&quot;;Province[23]=&quot;è¾½å®&quot;; Province[24]=&quot;æ±Ÿè‹&quot;;Province[25]=&quot;ç”˜è‚ƒ&quot;;Province[26]=&quot;é’æµ·&quot;;Province[27]=&quot;å››å·&quot;;</span></span><br><span class="line"><span class="string">        Province[28]=&quot;å®‰å¾½&quot;; Province[29]=&quot;å®å¤&quot;;Province[30]=&quot;æµ·å—&quot;;Province[31]=&quot;é¦™æ¸¯&quot;;Province[32]=&quot;æ¾³é—¨&quot;;Province[33]=&quot;å°æ¹¾&quot;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        id=id+1;</span></span><br><span class="line"><span class="string">        value=int(rand()*34);       </span></span><br><span class="line"><span class="string">        print id&quot;\t&quot;$1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$5&quot;\t&quot;substr($6,1,10)&quot;\t&quot;Province[value]</span></span><br><span class="line"><span class="string">    &#125;&#x27;</span> <span class="variable">$infile</span>&gt; <span class="variable">$outfile</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢å°±å¯ä»¥æ‰§è¡Œpre_deal.shè„šæœ¬æ–‡ä»¶ï¼Œæ¥å¯¹raw_user.csvè¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/bigdatacase/dataset</span><br><span class="line">bash ./pre_deal.sh raw_user.csv user_table.txt</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨headå‘½ä»¤æŸ¥çœ‹å‰10è¡Œæ•°æ®</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">head</span> -10 user_table.txt</span><br></pre></td></tr></table></figure>
<h3 id="å¯¼å…¥æ•°æ®åº“"><a class="markdownIt-Anchor" href="#å¯¼å…¥æ•°æ®åº“"></a> å¯¼å…¥æ•°æ®åº“</h3>
<p><strong>å¯åŠ¨HDFS</strong></p>
<p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¯åŠ¨Hadoopï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¾“å…¥jpså‘½ä»¤æŸ¥çœ‹å½“å‰çš„è¿›ç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">43529 NameNode</span><br><span class="line">43692 DataNode</span><br><span class="line">63644 Jps</span><br><span class="line">43901 SecondaryNameNode</span><br></pre></td></tr></table></figure>
<p><strong>æŠŠuser_table.txtä¸Šä¼ åˆ°HDFSä¸­</strong></p>
<p>åœ¨HDFSçš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•bigdatacaseå¹¶åœ¨è¿™ä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå­ç›®å½•<code>dataset</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">mkdir</span> -p /bigdatacase/dataset</span><br></pre></td></tr></table></figure>
<p>ç„¶åæŠŠæœ¬åœ°çš„user_table.txtä¸Šä¼ åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFSçš„<code>/bigdatacase/dataset</code>ç›®å½•ä¸‹</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -put /usr/local/bigdatacase/dataset/user_table.txt /bigdatacase/dataset</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æŸ¥çœ‹ä»¥ä¸‹HDFSä¸­<code>user_table.txt</code>çš„å‰10æ¡è®°å½•</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">cat</span> /bigdatacase/dataset/user_table.txt | <span class="built_in">head</span> -10</span><br></pre></td></tr></table></figure>
<p><strong>åœ¨Hiveä¸Šåˆ›å»ºæ•°æ®åº“</strong></p>
<p>é¦–å…ˆå¯åŠ¨MySQLæ•°æ®åº“</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨hiveçš„å…ƒæ•°æ®</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive --service metastore</span><br></pre></td></tr></table></figure>
<p>åœ¨æ–°çš„ç»ˆç«¯ä¸‹è¿›å…¥Hive</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure>
<p>åœ¨Hiveä¸­åˆ›å»ºä¸€ä¸ªæ•°æ®åº“dblab</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create database dblab;</span><br><span class="line">hive&gt; use dblab;</span><br></pre></td></tr></table></figure>
<p><strong>åˆ›å»ºå¤–éƒ¨è¡¨</strong></p>
<p>åœ¨hiveå‘½ä»¤æç¤ºç¬¦ä¸‹è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; CREATE EXTERNAL TABLE dblab.bigdata_user(id INT,uid STRING,item_id STRING,behavior_type INT,item_category STRING,visit_date DATE,province STRING) COMMENT &#x27;Welcome to xmudblab!&#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\t&#x27; STORED AS TEXTFILE LOCATION &#x27;/bigdatacase/dataset&#x27;;</span><br></pre></td></tr></table></figure>
<p><strong>æŸ¥è¯¢æ•°æ®</strong></p>
<p>åœ¨â€œhive&gt;â€å‘½ä»¤æç¤ºç¬¦çŠ¶æ€ä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹è¡¨çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; use dblab;//ä½¿ç”¨dblabæ•°æ®åº“</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.613 seconds</span><br><span class="line">hive&gt; show tables;//æ˜¾ç¤ºæ•°æ®åº“ä¸­æ‰€æœ‰è¡¨</span><br><span class="line">OK</span><br><span class="line">bigdata_user</span><br><span class="line">Time taken: 0.161 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; show create table bigdata_user;//æŸ¥çœ‹bigdata_userè¡¨çš„å„ç§å±æ€§ï¼›</span><br><span class="line">OK</span><br><span class="line">CREATE EXTERNAL TABLE `bigdata_user`(</span><br><span class="line">  `id` int, </span><br><span class="line">  `uid` string, </span><br><span class="line">  `item_id` string, </span><br><span class="line">  `behavior_type` int, </span><br><span class="line">  `item_category` string, </span><br><span class="line">  `visit_date` date, </span><br><span class="line">  `province` string)</span><br><span class="line">COMMENT &#x27;Welcome to xmudblab!&#x27;</span><br><span class="line">ROW FORMAT SERDE </span><br><span class="line">  &#x27;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#x27; </span><br><span class="line">WITH SERDEPROPERTIES ( </span><br><span class="line">  &#x27;field.delim&#x27;=&#x27;\t&#x27;, </span><br><span class="line">  &#x27;serialization.format&#x27;=&#x27;\t&#x27;) </span><br><span class="line">STORED AS INPUTFORMAT </span><br><span class="line">  &#x27;org.apache.hadoop.mapred.TextInputFormat&#x27; </span><br><span class="line">OUTPUTFORMAT </span><br><span class="line">  &#x27;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#x27;</span><br><span class="line">LOCATION</span><br><span class="line">  &#x27;hdfs://localhost:9000/bigdatacase/dataset&#x27;</span><br><span class="line">TBLPROPERTIES (</span><br><span class="line">  &#x27;bucketing_version&#x27;=&#x27;2&#x27;, </span><br><span class="line">  &#x27;transient_lastDdlTime&#x27;=&#x27;1718472356&#x27;)</span><br><span class="line">Time taken: 0.198 seconds, Fetched: 23 row(s)</span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹è¡¨çš„ç®€å•ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; desc bigdata_user;</span><br><span class="line">OK</span><br><span class="line">id                      int                                         </span><br><span class="line">uid                     string                                      </span><br><span class="line">item_id                 string                                      </span><br><span class="line">behavior_type           int                                         </span><br><span class="line">item_category           string                                      </span><br><span class="line">visit_date              date                                        </span><br><span class="line">province                string                                      </span><br><span class="line">Time taken: 0.055 seconds, Fetched: 7 row(s)</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥è¯¢ç›¸å…³æ•°æ®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from bigdata_user limit 10;</span><br><span class="line">OK</span><br><span class="line">1       10001082        285259775       1       4076    2014-12-08      æ¹–å—</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      å®‰å¾½</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      æ–°ç–†</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      ä¸Šæµ·å¸‚</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é»‘é¾™æ±Ÿ</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      å¹¿ä¸œ</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      é’æµ·</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      é¦™æ¸¯</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å±±è¥¿</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      å®å¤</span><br><span class="line">Time taken: 1.483 seconds, Fetched: 10 row(s)</span><br><span class="line">hive&gt; select behavior_type from bigdata_user limit 10;</span><br><span class="line">OK</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">Time taken: 0.106 seconds, Fetched: 10 row(s)</span><br><span class="line">hive&gt; </span><br></pre></td></tr></table></figure>
<h2 id="hiveæ•°æ®åˆ†æ"><a class="markdownIt-Anchor" href="#hiveæ•°æ®åˆ†æ"></a> Hiveæ•°æ®åˆ†æ</h2>
<h3 id="ç®€å•æŸ¥è¯¢åˆ†æ"><a class="markdownIt-Anchor" href="#ç®€å•æŸ¥è¯¢åˆ†æ"></a> ç®€å•æŸ¥è¯¢åˆ†æ</h3>
<p>é¦–å…ˆæ‰§è¡Œä¸€æ¡ç®€å•çš„æŒ‡ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select behavior_type from bigdata_user limit 10;#æŸ¥çœ‹å‰10ä½ç”¨æˆ·å¯¹å•†å“çš„è¡Œä¸º</span><br><span class="line">OK</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">Time taken: 0.116 seconds, Fetched: 10 row(s)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦æŸ¥å‡ºæ¯ä½ç”¨æˆ·è´­ä¹°å•†å“æ—¶çš„å¤šç§ä¿¡æ¯ï¼Œè¾“å‡ºè¯­å¥æ ¼å¼å¦‚ä¸‹ï¼š<br />
select åˆ—1ï¼Œåˆ—2ï¼Œâ€¦.ï¼Œåˆ—n from è¡¨åï¼›<br />
æ¯”å¦‚æŸ¥è¯¢å‰20ä½ç”¨æˆ·è´­ä¹°å•†å“æ—¶çš„æ—¶é—´å’Œå•†å“çš„ç§ç±»ï¼Œè¯­å¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select visit_date, item_category from bigdata_user limit 20;</span><br><span class="line">OK</span><br><span class="line">2014-12-08      4076</span><br><span class="line">2014-12-12      5503</span><br><span class="line">2014-12-12      5503</span><br><span class="line">2014-12-02      9762</span><br><span class="line">2014-12-12      5232</span><br><span class="line">2014-12-02      9762</span><br><span class="line">2014-12-12      5503</span><br><span class="line">2014-12-12      10894</span><br><span class="line">2014-12-12      6513</span><br><span class="line">2014-12-12      10894</span><br><span class="line">2014-12-12      2825</span><br><span class="line">2014-11-28      2825</span><br><span class="line">2014-12-15      3200</span><br><span class="line">2014-12-03      10576</span><br><span class="line">2014-11-20      10576</span><br><span class="line">2014-12-13      10576</span><br><span class="line">2014-12-08      10576</span><br><span class="line">2014-12-14      7079</span><br><span class="line">2014-12-02      6669</span><br><span class="line">2014-12-12      5232</span><br><span class="line">Time taken: 0.089 seconds, Fetched: 20 row(s)</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶åœ¨è¡¨ä¸­æŸ¥è¯¢å¯ä»¥åˆ©ç”¨åµŒå¥—è¯­å¥ï¼Œå¦‚æœåˆ—åå¤ªå¤æ‚å¯ä»¥è®¾ç½®è¯¥åˆ—çš„åˆ«åï¼Œä»¥ç®€åŒ–æ“ä½œçš„éš¾åº¦ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select e.bh, e.it from (select behavior_type as bh, item_category as it from bigdata_user) as e  limit 20;</span><br><span class="line">OK</span><br><span class="line">1       4076</span><br><span class="line">1       5503</span><br><span class="line">1       5503</span><br><span class="line">1       9762</span><br><span class="line">1       5232</span><br><span class="line">4       9762</span><br><span class="line">1       5503</span><br><span class="line">1       10894</span><br><span class="line">1       6513</span><br><span class="line">1       10894</span><br><span class="line">1       2825</span><br><span class="line">1       2825</span><br><span class="line">1       3200</span><br><span class="line">1       10576</span><br><span class="line">1       10576</span><br><span class="line">1       10576</span><br><span class="line">1       10576</span><br><span class="line">1       7079</span><br><span class="line">1       6669</span><br><span class="line">1       5232</span><br><span class="line">Time taken: 0.102 seconds, Fetched: 20 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡"></a> æŸ¥è¯¢æ¡æ•°ç»Ÿè®¡</h3>
<p>ç”¨èšåˆå‡½æ•°count()è®¡ç®—å‡ºè¡¨å†…æœ‰å¤šå°‘è¡Œæ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user;</span><br><span class="line">Query ID = hadoop_20240616014249_4ec3aa87-0a06-409c-9c43-40b0dd14ced7</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:42:51,137 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:42:52,142 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:42:57,166 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local460403743_0001</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 5169193912 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">23291027</span><br><span class="line">Time taken: 8.173 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p>åœ¨å‡½æ•°å†…éƒ¨åŠ ä¸Šdistinctï¼ŒæŸ¥å‡ºuidä¸é‡å¤çš„æ•°æ®æœ‰å¤šå°‘æ¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(distinct uid) from bigdata_user;</span><br><span class="line">Query ID = hadoop_20240616014323_2c95c94e-e87b-4d88-9ae6-8a9ca4e8fc61</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:43:24,499 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:43:27,501 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:43:40,630 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local544803189_0002</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 12623097568 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">20000</span><br><span class="line">Time taken: 17.605 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢ä¸é‡å¤çš„æ•°æ®æœ‰å¤šå°‘æ¡(ä¸ºäº†æ’é™¤å®¢æˆ·åˆ·å•æƒ…å†µ)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from (select uid,item_id,behavior_type,item_category,visit_date,province from bigdata_user group by uid,item_id,behavior_type,item_category,visit_date,province       having count(*)=1) a;</span><br><span class="line">Query ID = hadoop_20240616014446_fc30d1c3-d4c1-486e-85ce-0a79b93223f2</span><br><span class="line">Total jobs = 2</span><br><span class="line">Launching Job 1 out of 2</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 5</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:44:48,421 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:45:05,693 Stage-1 map = 7%,  reduce = 0%</span><br><span class="line">2024-06-16 01:45:30,144 Stage-1 map = 18%,  reduce = 0%</span><br><span class="line">2024-06-16 01:45:32,205 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:45:44,425 Stage-1 map = 20%,  reduce = 0%</span><br><span class="line">2024-06-16 01:45:50,471 Stage-1 map = 27%,  reduce = 0%</span><br><span class="line">2024-06-16 01:46:08,032 Stage-1 map = 33%,  reduce = 0%</span><br><span class="line">2024-06-16 01:46:13,059 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:46:24,425 Stage-1 map = 40%,  reduce = 0%</span><br><span class="line">2024-06-16 01:46:30,623 Stage-1 map = 47%,  reduce = 0%</span><br><span class="line">2024-06-16 01:46:48,985 Stage-1 map = 54%,  reduce = 0%</span><br><span class="line">2024-06-16 01:46:54,057 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:06,424 Stage-1 map = 60%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:12,464 Stage-1 map = 67%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:30,843 Stage-1 map = 74%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:33,963 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:46,284 Stage-1 map = 80%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:51,291 Stage-1 map = 91%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:57,476 Stage-1 map = 95%,  reduce = 0%</span><br><span class="line">2024-06-16 01:47:59,479 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:48:11,495 Stage-1 map = 100%,  reduce = 20%</span><br><span class="line">2024-06-16 01:48:24,516 Stage-1 map = 100%,  reduce = 40%</span><br><span class="line">2024-06-16 01:48:36,535 Stage-1 map = 100%,  reduce = 60%</span><br><span class="line">2024-06-16 01:48:48,554 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">2024-06-16 01:48:49,556 Stage-1 map = 100%,  reduce = 80%</span><br><span class="line">2024-06-16 01:49:00,573 Stage-1 map = 100%,  reduce = 99%</span><br><span class="line">2024-06-16 01:49:01,578 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local924134795_0003</span><br><span class="line">Launching Job 2 out of 2</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:49:02,850 Stage-2 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1145871970_0004</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 34984890456 HDFS Write: 0 SUCCESS</span><br><span class="line">Stage-Stage-2:  HDFS Read: 7453944616 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">22080451</span><br><span class="line">Time taken: 255.925 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ"><a class="markdownIt-Anchor" href="#å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ"></a> å…³é”®å­—æ¡ä»¶æŸ¥è¯¢åˆ†æ</h3>
<p><strong>ä»¥å…³é”®å­—çš„å­˜åœ¨åŒºé—´ä¸ºæ¡ä»¶çš„æŸ¥è¯¢</strong></p>
<p>æŸ¥è¯¢2014å¹´12æœˆ10æ—¥åˆ°2014å¹´12æœˆ13æ—¥æœ‰å¤šå°‘äººæµè§ˆäº†å•†å“ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user where behavior_type=&#x27;1&#x27; and visit_date&lt;&#x27;2014-12-13&#x27; and visit_date&gt;&#x27;2014-12-10&#x27;;</span><br><span class="line">Query ID = hadoop_20240616015218_900aa649-9b2c-4a24-8ebf-6b6a50cb5a06</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:52:19,677 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:52:27,914 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:52:59,420 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local2129098898_0005</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 27530904880 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">2137738</span><br><span class="line">Time taken: 41.237 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p>ä»¥æœˆçš„ç¬¬nå¤©ä¸ºç»Ÿè®¡å•ä½ï¼Œä¾æ¬¡æ˜¾ç¤ºç¬¬nå¤©ç½‘ç«™å–å‡ºå»çš„å•†å“çš„ä¸ªæ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(distinct uid), day(visit_date) from bigdata_user where behavior_type=&#x27;4&#x27; group by day(visit_date);</span><br><span class="line">Query ID = hadoop_20240616015346_c33511b1-be1b-4631-9e87-74152ae033e7</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 5</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:53:48,126 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:53:51,128 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:54:04,164 Stage-1 map = 100%,  reduce = 60%</span><br><span class="line">2024-06-16 01:54:05,167 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1718417321_0006</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 59831235976 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">3098    1</span><br><span class="line">2969    8</span><br><span class="line">3110    13</span><br><span class="line">3225    16</span><br><span class="line">5267    18</span><br><span class="line">2780    21</span><br><span class="line">3104    24</span><br><span class="line">3121    4</span><br><span class="line">2804    5</span><br><span class="line">2910    11</span><br><span class="line">2922    19</span><br><span class="line">2763    22</span><br><span class="line">2990    25</span><br><span class="line">2825    26</span><br><span class="line">2828    28</span><br><span class="line">3137    3</span><br><span class="line">2957    14</span><br><span class="line">3284    15</span><br><span class="line">3049    17</span><br><span class="line">2893    23</span><br><span class="line">2867    7</span><br><span class="line">2794    9</span><br><span class="line">7604    12</span><br><span class="line">2862    20</span><br><span class="line">2913    27</span><br><span class="line">3161    2</span><br><span class="line">2850    6</span><br><span class="line">2869    10</span><br><span class="line">2710    29</span><br><span class="line">3018    30</span><br><span class="line">Time taken: 18.451 seconds, Fetched: 30 row(s)</span><br></pre></td></tr></table></figure>
<p><strong>å…³é”®å­—èµ‹äºˆç»™å®šå€¼ä¸ºæ¡ä»¶ï¼Œå¯¹å…¶ä»–æ•°æ®è¿›è¡Œåˆ†æ</strong></p>
<p>å–ç»™å®šæ—¶é—´å’Œç»™å®šåœ°ç‚¹ï¼Œæ±‚å½“å¤©å‘å‡ºåˆ°è¯¥åœ°ç‚¹çš„è´§ç‰©çš„æ•°é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user where province=&#x27;æ±Ÿè¥¿&#x27; and visit_date=&#x27;2014-12-12&#x27; and behavior_type=&#x27;4&#x27;;</span><br><span class="line">Query ID = hadoop_20240616015514_7f149dba-f8a0-4191-a9d9-399ca649580b</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:55:15,459 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:55:24,635 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:55:58,440 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local2110211223_0007</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 42438712192 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">885</span><br><span class="line">Time taken: 44.359 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ"><a class="markdownIt-Anchor" href="#æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ"></a> æ ¹æ®ç”¨æˆ·è¡Œä¸ºåˆ†æ</h3>
<p><strong>æŸ¥è¯¢ä¸€ä»¶å•†å“åœ¨æŸå¤©çš„è´­ä¹°æ¯”ä¾‹æˆ–æµè§ˆæ¯”ä¾‹</strong></p>
<p>æŸ¥è¯¢æœ‰å¤šå°‘ç”¨æˆ·åœ¨2014-12-11è´­ä¹°äº†å•†å“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user where visit_date=&#x27;2014-12-11&#x27;and behavior_type=&#x27;4&#x27;;</span><br><span class="line">Query ID = hadoop_20240616015657_97eeb057-f1c4-4615-8b9c-b52eecb32691</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:56:58,654 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:57:07,712 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:57:39,940 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local208501678_0008</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 49892615848 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">6771</span><br><span class="line">Time taken: 42.782 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢æœ‰å¤šå°‘ç”¨æˆ·åœ¨2014-12-11ç‚¹å‡»äº†è¯¥åº—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user where visit_date =&#x27;2014-12-11&#x27;;</span><br><span class="line">Query ID = hadoop_20240616015820_54043f5d-8fb0-4dd9-97c8-8f2f29d8cc1f</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 01:58:22,332 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 01:58:30,479 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 01:59:01,726 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local981603111_0009</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 57346519504 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">944979</span><br><span class="line">Time taken: 40.809 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p><strong>æŸ¥è¯¢æŸä¸ªç”¨æˆ·åœ¨æŸä¸€å¤©ç‚¹å‡»ç½‘ç«™å è¯¥å¤©æ‰€æœ‰ç‚¹å‡»è¡Œä¸ºçš„æ¯”ä¾‹ï¼ˆç‚¹å‡»è¡Œä¸ºåŒ…æ‹¬æµè§ˆã€åŠ å…¥è´­ç‰©è½¦ã€æ”¶è—ã€è´­ä¹°ï¼‰</strong></p>
<p>æŸ¥è¯¢ç”¨æˆ·10001082åœ¨2014-12-12ç‚¹å‡»ç½‘ç«™çš„æ¬¡æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user where uid=10001082 and visit_date=&#x27;2014-12-12&#x27;;</span><br><span class="line">Query ID = hadoop_20240616020035_9ad77af3-2cba-4456-924d-9646ed7be7d0</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 02:00:36,927 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 02:00:46,135 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:01:20,744 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local219554971_0010</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 64800423160 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">69</span><br><span class="line">Time taken: 45.22 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·åœ¨è¿™ä¸€å¤©ç‚¹å‡»è¯¥ç½‘ç«™çš„æ¬¡æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select count(*) from bigdata_user where visit_date=&#x27;2014-12-12&#x27;;</span><br><span class="line">Query ID = hadoop_20240616020246_fcb99cc6-d131-4e1c-9cc0-ce38b7de499d</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 02:02:48,411 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 02:02:56,581 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:03:28,882 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1580275434_0011</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 72254326816 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">1344980</span><br><span class="line">Time taken: 41.911 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure>
<p><strong>ç»™å®šè´­ä¹°å•†å“çš„æ•°é‡èŒƒå›´ï¼ŒæŸ¥è¯¢æŸä¸€å¤©åœ¨è¯¥ç½‘ç«™çš„è´­ä¹°è¯¥æ•°é‡å•†å“çš„ç”¨æˆ·id</strong></p>
<p>æŸ¥è¯¢æŸä¸€å¤©åœ¨è¯¥ç½‘ç«™è´­ä¹°å•†å“è¶…è¿‡5æ¬¡çš„ç”¨æˆ·id</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select uid from bigdata_user where behavior_type=&#x27;4&#x27; and visit_date=&#x27;2014-12-12&#x27; group by uid having count(behavior_type=&#x27;4&#x27;)&gt;5;</span><br><span class="line">Query ID = hadoop_20240616020903_0ad7cef8-7e49-4107-8683-fd98599a18e1</span><br><span class="line">Total jobs = 1</span><br><span class="line">Launching Job 1 out of 1</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 5</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 02:09:07,206 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 02:09:18,314 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:09:56,917 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local1592485813_0001</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 10138340136 HDFS Write: 0 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">100605</span><br><span class="line">100728355</span><br><span class="line">100796503</span><br><span class="line">10095384</span><br><span class="line">...</span><br><span class="line">64315314</span><br><span class="line">6500849</span><br><span class="line">65095287</span><br><span class="line">6534626</span><br><span class="line">Time taken: 53.599 seconds, Fetched: 1564 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ"><a class="markdownIt-Anchor" href="#ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ"></a> ç”¨æˆ·å®æ—¶æŸ¥è¯¢åˆ†æ</h3>
<p><strong>æŸ¥è¯¢æŸä¸ªåœ°åŒºçš„ç”¨æˆ·å½“å¤©æµè§ˆç½‘ç«™çš„æ¬¡æ•°</strong></p>
<p>åˆ›å»ºæ–°çš„æ•°æ®è¡¨è¿›è¡Œå­˜å‚¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create table scan(province STRING,scan INT) COMMENT &#x27;This is the search of bigdataday&#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\t&#x27; STORED AS TEXTFILE;</span><br><span class="line">OK</span><br><span class="line">Time taken: 1.17 seconds</span><br></pre></td></tr></table></figure>
<p>å¯¼å…¥æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; insert overwrite table scan select province,count(behavior_type) from bigdata_user where behavior_type=&#x27;1&#x27; group by province;</span><br><span class="line">Query ID = hadoop_20240616021413_4ab776e4-cc98-475c-95bc-6973ee82e279</span><br><span class="line">Total jobs = 2</span><br><span class="line">Launching Job 1 out of 2</span><br><span class="line">Number of reduce tasks not specified. Estimated from input data size: 5</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 02:14:15,184 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 02:14:17,188 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:14:27,290 Stage-1 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local52434044_0002</span><br><span class="line">Loading data to table dblab.scan</span><br><span class="line">Launching Job 2 out of 2</span><br><span class="line">Number of reduce tasks determined at compile time: 1</span><br><span class="line">In order to change the average load for a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line">In order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line">In order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 02:14:28,626 Stage-3 map = 100%,  reduce = 100%</span><br><span class="line">Ended Job = job_local2032099341_0003</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 22561512896 HDFS Write: 2644 SUCCESS</span><br><span class="line">Stage-Stage-3:  HDFS Read: 4969269104 HDFS Write: 1654 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">Time taken: 15.49 seconds</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from scan;</span><br><span class="line">OK</span><br><span class="line">å°æ¹¾    645421</span><br><span class="line">å››å·    646636</span><br><span class="line">å®å¤    643964</span><br><span class="line">å®‰å¾½    645594</span><br><span class="line">å¹¿ä¸œ    643067</span><br><span class="line">å¹¿è¥¿    645380</span><br><span class="line">æ²³å—    645191</span><br><span class="line">è´µå·    645203</span><br><span class="line">è¾½å®    644007</span><br><span class="line">é™•è¥¿    645452</span><br><span class="line">å‰æ—    645223</span><br><span class="line">æ±Ÿè¥¿    644830</span><br><span class="line">ç”˜è‚ƒ    645495</span><br><span class="line">è¥¿è—    644691</span><br><span class="line">é‡åº†å¸‚  645230</span><br><span class="line">ä¸Šæµ·å¸‚  644384</span><br><span class="line">äº‘å—    645295</span><br><span class="line">åŒ—äº¬å¸‚  645735</span><br><span class="line">æ±Ÿè‹    646701</span><br><span class="line">æµ™æ±Ÿ    645915</span><br><span class="line">æµ·å—    646311</span><br><span class="line">æ¹–åŒ—    645080</span><br><span class="line">é’æµ·    645554</span><br><span class="line">å†…è’™å¤  645438</span><br><span class="line">å¤©æ´¥å¸‚  645704</span><br><span class="line">å±±ä¸œ    646162</span><br><span class="line">å±±è¥¿    644977</span><br><span class="line">æ–°ç–†    644826</span><br><span class="line">æ¹–å—    645725</span><br><span class="line">æ¾³é—¨    645513</span><br><span class="line">é¦™æ¸¯    644758</span><br><span class="line">é»‘é¾™æ±Ÿ  645571</span><br><span class="line">æ²³åŒ—    645313</span><br><span class="line">ç¦å»º    646174</span><br><span class="line">Time taken: 0.093 seconds, Fetched: 34 row(s)</span><br></pre></td></tr></table></figure>
<h2 id="hive-mysql-hbaseæ•°æ®äº’å¯¼"><a class="markdownIt-Anchor" href="#hive-mysql-hbaseæ•°æ®äº’å¯¼"></a> Hiveã€MySQLã€HBaseæ•°æ®äº’å¯¼</h2>
<h3 id="hiveé¢„æ“ä½œ"><a class="markdownIt-Anchor" href="#hiveé¢„æ“ä½œ"></a> Hiveé¢„æ“ä½œ</h3>
<p>åˆ›å»ºä¸´æ—¶è¡¨<code>user_action</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create table dblab.user_action(id STRING,uid STRING, item_id STRING, behavior_type STRING, item_category STRING, visit_date DATE, province STRING) COMMENT &#x27;Welcome to XMU dblab! &#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\t&#x27; STORED AS TEXTFILE;</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.277 seconds</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å¯ä»¥æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œå‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ï¼Œç¡®è®¤è¿™ä¸ªæ•°æ®æ–‡ä»¶åœ¨HDFSä¸­ç¡®å®å·²ç»è¢«åˆ›å»ºï¼Œåœ¨æ–°å»ºçš„ç»ˆç«¯ä¸­æ‰§è¡Œä¸‹é¢å‘½ä»¤</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">ls</span> /user/hive/warehouse/dblab.db/</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ç›®å½•å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Found 2 items</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2024-06-16 02:14 /user/hive/warehouse/dblab.db/scan</span><br><span class="line">drwxr-xr-x   - hadoop supergroup          0 2024-06-16 02:18 /user/hive/warehouse/dblab.db/user_action</span><br></pre></td></tr></table></figure>
<p><strong>å°†<code>bigdata_user</code>è¡¨ä¸­çš„æ•°æ®æ’å…¥åˆ°<code>user_action</code></strong></p>
<p>ä¸‹é¢æŠŠ<code>dblab.bigdata_user</code>æ•°æ®æ’å…¥åˆ°<code>dblab.user_action</code>è¡¨ä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; INSERT OVERWRITE TABLE dblab.user_action select * from dblab.bigdata_user;</span><br><span class="line">Query ID = hadoop_20240616022349_4259971c-f495-4711-be42-69c01bc36c59</span><br><span class="line">Total jobs = 3</span><br><span class="line">Launching Job 1 out of 3</span><br><span class="line">Number of reduce tasks is set to 0 since there&#x27;s no reduce operator</span><br><span class="line">Job running in-process (local Hadoop)</span><br><span class="line">2024-06-16 02:23:51,241 Stage-1 map = 0%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:03,244 Stage-1 map = 10%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:06,246 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:18,254 Stage-1 map = 30%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:24,260 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:36,268 Stage-1 map = 50%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:41,272 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:53,281 Stage-1 map = 70%,  reduce = 0%</span><br><span class="line">2024-06-16 02:24:58,285 Stage-1 map = 100%,  reduce = 0%</span><br><span class="line">Ended Job = job_local1890104177_0013</span><br><span class="line">Stage-4 is selected by condition resolver.</span><br><span class="line">Stage-3 is filtered out by condition resolver.</span><br><span class="line">Stage-5 is filtered out by condition resolver.</span><br><span class="line">Moving data to directory hdfs://localhost:9000/user/hive/warehouse/dblab.db/user_action/.hive-staging_hive_2024-06-16_02-23-49_848_6247200484593972572-1/-ext-10000</span><br><span class="line">Loading data to table dblab.user_action</span><br><span class="line">MapReduce Jobs Launched: </span><br><span class="line">Stage-Stage-1:  HDFS Read: 72254308806 HDFS Write: 3926636398 SUCCESS</span><br><span class="line">Total MapReduce CPU Time Spent: 0 msec</span><br><span class="line">OK</span><br><span class="line">Time taken: 79.633 seconds</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥è¯¢ä¸Šé¢çš„æ’å…¥å‘½ä»¤æ˜¯å¦æˆåŠŸæ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from user_action limit 10;</span><br><span class="line">OK</span><br><span class="line">1       10001082        285259775       1       4076    2014-12-08      æ¹–å—</span><br><span class="line">2       10001082        4368907 1       5503    2014-12-12      å®‰å¾½</span><br><span class="line">3       10001082        4368907 1       5503    2014-12-12      æ–°ç–†</span><br><span class="line">4       10001082        53616768        1       9762    2014-12-02      ä¸Šæµ·å¸‚</span><br><span class="line">5       10001082        151466952       1       5232    2014-12-12      é»‘é¾™æ±Ÿ</span><br><span class="line">6       10001082        53616768        4       9762    2014-12-02      å¹¿ä¸œ</span><br><span class="line">7       10001082        290088061       1       5503    2014-12-12      é’æµ·</span><br><span class="line">8       10001082        298397524       1       10894   2014-12-12      é¦™æ¸¯</span><br><span class="line">9       10001082        32104252        1       6513    2014-12-12      å±±è¥¿</span><br><span class="line">10      10001082        323339743       1       10894   2014-12-12      å®å¤</span><br><span class="line">Time taken: 0.081 seconds, Fetched: 10 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨java-apiå°†æ•°æ®ä»hiveå¯¼å…¥mysql"><a class="markdownIt-Anchor" href="#ä½¿ç”¨java-apiå°†æ•°æ®ä»hiveå¯¼å…¥mysql"></a> ä½¿ç”¨Java APIå°†æ•°æ®ä»Hiveå¯¼å…¥MySQL</h3>
<p><strong>å°†å‰é¢ç”Ÿæˆçš„ä¸´æ—¶è¡¨æ•°æ®ä»Hiveå¯¼å…¥åˆ° MySQLä¸­</strong></p>
<p>ç™»å½•MySQL</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mysql -u root</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºæ•°æ®åº“å¹¶æˆæƒç»™<code>hadoop</code>ç”¨æˆ·</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> databases; # æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> Database           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> hive               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> information_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mysql              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> performance_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sys                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> database dblab; åˆ›å»ºdblabæ•°æ®åº“</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> dblab.<span class="operator">*</span> <span class="keyword">to</span> hadoop; # å°†dblabæ•°æ®åº“æˆæƒç»™hadoopç”¨æˆ·</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<p>é€€å‡º<code>root</code>ç”¨æˆ·</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> exit;</span><br><span class="line">Bye</span><br></pre></td></tr></table></figure>
<p>ç™»é™†<code>hadoop</code>ç”¨æˆ·</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> databases; # æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> Database           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> dblab              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> hive               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> information_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> performance_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> use dblab;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹æ•°æ®åº“çš„ç¼–ç </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> &quot;char%&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name            <span class="operator">|</span> <span class="keyword">Value</span>                      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span> character_set_client     <span class="operator">|</span> utf8mb4                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_connection <span class="operator">|</span> utf8mb4                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_database   <span class="operator">|</span> utf8mb4                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_filesystem <span class="operator">|</span> <span class="type">binary</span>                     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_results    <span class="operator">|</span> utf8mb4                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_server     <span class="operator">|</span> utf8mb4                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_system     <span class="operator">|</span> utf8mb3                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_sets_dir       <span class="operator">|</span> <span class="operator">/</span>usr<span class="operator">/</span>share<span class="operator">/</span>mysql<span class="operator">/</span>charsets<span class="operator">/</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+----------------------------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœcharacter_set_serverä¸æ˜¯utf8ä¹‹ç±»çš„ç¼–ç ï¼Œåˆ™éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<p>åœ¨<code>[mysqld]</code>ä¸‹æ·»åŠ ä¸€è¡Œ<code>character_set_server=utf8</code></p>
<figure class="highlight plaintext"><figcaption><span>/etc/mysql/mysql.conf.d/mysqld.cnf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">character_set_server=utf8</span><br></pre></td></tr></table></figure>
<p>ç„¶åé‡å¯MySQLæœåŠ¡</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> service mysql restart</span><br></pre></td></tr></table></figure>
</blockquote>
<p>åˆ›å»ºè¡¨</p>
<p>ä¸‹é¢åœ¨MySQLçš„æ•°æ®åº“<code>dblab</code>ä¸­åˆ›å»ºä¸€ä¸ªæ–°è¡¨<code>user_action</code>ï¼Œå¹¶è®¾ç½®å…¶ç¼–ç ä¸º<code>utf-8</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `dblab`.`user_action` (`id` <span class="type">varchar</span>(<span class="number">50</span>),`uid` <span class="type">varchar</span>(<span class="number">50</span>),`item_id` <span class="type">varchar</span>(<span class="number">50</span>),`behavior_type` <span class="type">varchar</span>(<span class="number">10</span>),`item_category` <span class="type">varchar</span>(<span class="number">50</span>), `visit_date` <span class="type">DATE</span>,`province` <span class="type">varchar</span>(<span class="number">20</span>)) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected, <span class="number">1</span> warning (<span class="number">0.03</span> sec)</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºæˆåŠŸå<code>exit</code>é€€å‡ºMySQL</p>
<p>å¯¼å…¥æ•°æ®</p>
<p>é€šè¿‡JDBCè¿æ¥Hiveå’ŒMySQLï¼Œå°†æ•°æ®ä»Hiveå¯¼å…¥MySQLã€‚é€šè¿‡JDBCè¿æ¥Hiveï¼Œéœ€è¦é€šè¿‡Hiveçš„thriftæœåŠ¡å®ç°è·¨è¯­è¨€è®¿é—®Hiveï¼Œå®ç°thriftæœåŠ¡éœ€è¦å¼€å¯hiveserver2ã€‚</p>
<p>å¯åŠ¨HDFSä»¥åï¼Œåœ¨ç»ˆç«¯ä¸­å¯åŠ¨<code>metastore</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive --service metastore</span><br></pre></td></tr></table></figure>
<p>åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å¯<code>HiveServer2</code>ï¼Œå¹¶è®¾ç½®é»˜è®¤ç«¯å£ä¸º10000ï¼ˆå¦‚æœæŒ‰ç…§å‰é¢æ•™ç¨‹é…ç½®äº†hiveserver2çš„ç«¯å£ï¼Œè¿™é‡Œçš„<code>-hiveconf</code>é€‰é¡¹ä¸éœ€è¦æ·»åŠ ï¼‰</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive --service hiveserver2 -hiveconf hive.server2.thrift.port=10000</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨æ—¶ï¼Œå½“å±å¹•ä¸Šå‡ºç°â€œHive Session ID = 6bd1726e-37c5-41fc-93ea-ef7e176b24f2â€ä¿¡æ¯æ—¶ï¼Œä¼šåœç•™è¾ƒé•¿çš„æ—¶é—´ï¼Œéœ€è¦å‡ºç°å‡ ä¸ªâ€œHive Session ID=â€¦â€ä»¥åï¼ŒHiveæ‰ä¼šçœŸæ­£å¯åŠ¨ã€‚å¯åŠ¨æˆåŠŸä»¥åï¼Œä¼šå‡ºç°å¦‚ä¸‹ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hive Session ID = bb1c1106-83ce-4653-9541-c79a86945ea0</span><br><span class="line">Hive Session ID = 0e577e34-83c1-40de-9fb6-917be3d5e022</span><br></pre></td></tr></table></figure>
<p>ä¸è¦å…³é—­è¿™ä¸ªç»ˆç«¯ï¼Œä¿æŒæœåŠ¡çš„è¿è¡Œ</p>
<p>åœ¨æ–°çš„ç»ˆç«¯ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹10000å·å’Œ10002å·ç«¯å£æ˜¯å¦å·²ç»è¢«å ç”¨ï¼Œå¦‚æœè¢«å ç”¨ï¼Œè¯´æ˜å¯åŠ¨æˆåŠŸï¼Œå¯ä»¥åœ¨æµè§ˆå™¨è®¿é—®<code>127.0.0.1:10002</code>æ‰“å¼€hiveserver2çš„ç½‘é¡µæ¥å£</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> netstat -anp |grep <span class="string">&quot;10000\|10002&quot;</span></span><br></pre></td></tr></table></figure>
<p>ç«¯å£ä¿¡æ¯å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tcp6       0      0 :::10000                :::*                    LISTEN      76077/java          </span><br><span class="line">tcp6       0      0 :::10002                :::*                    LISTEN      76077/java</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨IntelliJ IDEAï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®åä¸ºHivetoMySQL</p>
<p>å°†<code>$HADOOP_HOME/share/hadoop/common</code>å’Œ<code>$HIVE_HOME/lib</code>ç›®å½•ä¸‹JARåŒ…å¯¼å…¥åˆ°é¡¹ç›®ä¸­ï¼Œ<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> <a id="jar"></a></p>
<ol>
<li>ç‚¹å‡»å·¥å…·æ çš„ File é€‰é¡¹</li>
<li>ç‚¹å‡» Project Structureï¼ˆCTRL + SHIFT + ALT + S on Windows/Linuxï¼ŒâŒ˜ + ; on Mac OS Xï¼‰</li>
<li>é€‰æ‹©å·¦ä¾§çš„ Modules é€‰é¡¹</li>
<li>é€‰æ‹© Dependencies tab</li>
<li>ç‚¹å‡» + â†’ JARs or directories</li>
<li>é€‰æ‹©éœ€è¦å¯¼å…¥JARåŒ…çš„æ‰€åœ¨ç›®å½•</li>
<li>ç‚¹å‡» Apply åº”ç”¨é€‰é¡¹</li>
</ol>
<p>å¯¼å…¥åå¯ä»¥åœ¨å·¦è¾¹çš„External Librariesä¸­çœ‹åˆ°å¯¼å…¥çš„JARåŒ…</p>
<p>åˆ é™¤åŸæœ‰çš„<code>Main</code>ç±»ï¼Œåˆ›å»ºä¸€ä¸ªå…¬å…±ç±»<code>HivetoMySQL</code></p>
<p>ç¼–å†™<code>HivetoMySQL.java</code>ä»£ç ï¼Œæ³¨æ„ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠç«¯å£æ˜¯å¦æ­£ç¡®ï¼Œè¿è¡Œä»£ç ç­‰å¾…å¯¼å…¥</p>
<p>ç„¶åå°±æ˜¯æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«æ¼«é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿é•¿çš„ç­‰å¾…æ—¶é—´â€¦ï¼ˆäººç”Ÿè‹¦çŸ­ï¼Œä¸è¦ç”¨raw_userâ€¦ï¼‰</p>
<figure class="highlight java"><figcaption><span>HivetoMySQL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HivetoMySQL</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driverName</span> <span class="operator">=</span> <span class="string">&quot;org.apache.hive.jdbc.HiveDriver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driverName_mysql</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driverName);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.exit(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con1</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:hive2://localhost:10000/default&quot;</span>, <span class="string">&quot;hive&quot;</span>, <span class="string">&quot;hive&quot;</span>);<span class="comment">//åä¸¤ä¸ªå‚æ•°æ˜¯ç”¨æˆ·åå¯†ç </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (con1 == <span class="literal">null</span>) System.out.println(<span class="string">&quot;è¿æ¥å¤±è´¥&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> con1.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from dblab.user_action&quot;</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;Running: &quot;</span> + sql);</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">res</span> <span class="operator">=</span> stmt.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//InsertToMysql</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Class.forName(driverName_mysql);</span><br><span class="line">                <span class="type">Connection</span> <span class="variable">con2</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/dblab&quot;</span>, <span class="string">&quot;hadoop&quot;</span>, <span class="string">&quot;hadoop&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;insert into user_action(id,uid,item_id,behavior_type,item_category,visit_date,province) values (?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">                <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> con2.prepareStatement(sql2);</span><br><span class="line">                <span class="keyword">while</span> (res.next()) &#123;</span><br><span class="line">                    ps.setString(<span class="number">1</span>, res.getString(<span class="number">1</span>));</span><br><span class="line">                    ps.setString(<span class="number">2</span>, res.getString(<span class="number">2</span>));</span><br><span class="line">                    ps.setString(<span class="number">3</span>, res.getString(<span class="number">3</span>));</span><br><span class="line">                    ps.setString(<span class="number">4</span>, res.getString(<span class="number">4</span>));</span><br><span class="line">                    ps.setString(<span class="number">5</span>, res.getString(<span class="number">5</span>));</span><br><span class="line">                    ps.setDate(<span class="number">6</span>, res.getDate(<span class="number">6</span>));</span><br><span class="line">                    ps.setString(<span class="number">7</span>, res.getString(<span class="number">7</span>));</span><br><span class="line">                    ps.executeUpdate();</span><br><span class="line">                &#125;</span><br><span class="line">                ps.close();</span><br><span class="line">                con2.close();</span><br><span class="line">                res.close();</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        con1.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨hbase-java-apiæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°hbaseä¸­"><a class="markdownIt-Anchor" href="#ä½¿ç”¨hbase-java-apiæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°hbaseä¸­"></a> ä½¿ç”¨HBase Java APIæŠŠæ•°æ®ä»æœ¬åœ°å¯¼å…¥åˆ°HBaseä¸­</h3>
<p><strong>æ•°æ®å‡†å¤‡</strong></p>
<p>å…ˆå°†ä¹‹å‰çš„<code>user_action</code>æ•°æ®ä»HDFSå¤åˆ¶åˆ°Linuxç³»ç»Ÿçš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -get /user/hive/warehouse/dblab.db/user_action /usr/local/bigdatacase/dataset/</span><br><span class="line"><span class="built_in">cat</span> /usr/local/bigdatacase/dataset/user_action/* | <span class="built_in">head</span> -10     <span class="comment"># æŸ¥çœ‹å‰åè¡Œæ•°æ®</span></span><br><span class="line"><span class="built_in">cat</span> /usr/local/bigdatacase/dataset/user_action/00000* &gt; /usr/local/bigdatacase/dataset/user_action.output    <span class="comment">#å°†00000*æ•°æ®å¤åˆ¶ä¸€ä»½å‘½åä¸º`user_action.output`</span></span><br><span class="line"><span class="built_in">head</span> /usr/local/bigdatacase/dataset/user_action.output      <span class="comment"># æŸ¥çœ‹user_action.outputçš„å‰åè¡Œ</span></span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œèµ·åå«<code>ImportHBase</code>ï¼Œåƒ<a href="#jar">ä¸Šé¢</a>ä¸€æ ·å°†ç›®å½•<code>$HADOOP_HOME/share/hadoop/common</code>å’Œ<code>$HBASE_HOME/lib</code>ä¸‹çš„JARåŒ…å¯¼å…¥åˆ°é¡¹ç›®ä¸­ï¼Œåˆ é™¤åŸæœ‰çš„<code>Main</code>ç±»ï¼Œæ–°å»ºä¸€ä¸ª<code>ImportHBase</code>ç±»</p>
<p>ç¼–å†™ä»£ç <code>ImportHBase.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImportHBase</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Configuration config;</span><br><span class="line">    <span class="keyword">public</span> Connection conn;</span><br><span class="line">    <span class="keyword">public</span> Table table;</span><br><span class="line">    <span class="keyword">public</span> Admin admin;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ImportHBase</span><span class="params">()</span> &#123;</span><br><span class="line">        config = HBaseConfiguration.create();</span><br><span class="line"><span class="comment">//      config.set(&quot;hbase.master&quot;, &quot;master:60000&quot;);</span></span><br><span class="line"><span class="comment">//      config.set(&quot;hbase.zookeeper.quorum&quot;, &quot;master&quot;);</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = ConnectionFactory.createConnection(config);</span><br><span class="line">            admin = conn.getAdmin();</span><br><span class="line">            table = conn.getTable(TableName.valueOf(<span class="string">&quot;user_action&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (args.length == <span class="number">0</span>) &#123;       <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯¥jaræ‰€ä½¿ç”¨çš„ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°æ®é›†æ‰€å­˜æ”¾çš„è·¯å¾„</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;You must set input path!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> args[args.length - <span class="number">1</span>];  <span class="comment">//è¾“å…¥çš„æ–‡ä»¶è·¯å¾„æ˜¯æœ€åä¸€ä¸ªå‚æ•°</span></span><br><span class="line">        <span class="type">ImportHBase</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ImportHBase</span>();</span><br><span class="line">        test.importLocalFileToHBase(fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">importLocalFileToHBase</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">st</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            br = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(</span><br><span class="line">                    fileName)));</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                count++;</span><br><span class="line">                put(line);</span><br><span class="line">                <span class="keyword">if</span> (count % <span class="number">10000</span> == <span class="number">0</span>)</span><br><span class="line">                    System.out.println(count);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (br != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    br.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                table.close(); <span class="comment">// must close the client</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">en2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;Total Time: &quot;</span> + (en2 - st) + <span class="string">&quot; ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;deprecation&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(String line)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        String[] arr = line.split(<span class="string">&quot;\t&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">        String[] column = &#123;<span class="string">&quot;id&quot;</span>, <span class="string">&quot;uid&quot;</span>, <span class="string">&quot;item_id&quot;</span>, <span class="string">&quot;behavior_type&quot;</span>, <span class="string">&quot;item_category&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;province&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (arr.length == <span class="number">7</span>) &#123;</span><br><span class="line">            <span class="type">Put</span> <span class="variable">put</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Put</span>(Bytes.toBytes(arr[<span class="number">0</span>]));<span class="comment">// rowkey</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">                put.addColumn(Bytes.toBytes(<span class="string">&quot;f1&quot;</span>), Bytes.toBytes(column[i]), Bytes.toBytes(arr[i]));</span><br><span class="line">            &#125;</span><br><span class="line">            table.put(put); <span class="comment">// put to server</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">(String rowkey, String columnFamily, String column,</span></span><br><span class="line"><span class="params">                    <span class="type">int</span> versions)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">st</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">Get</span> <span class="variable">get</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Get</span>(Bytes.toBytes(rowkey));</span><br><span class="line">        get.addColumn(Bytes.toBytes(columnFamily), Bytes.toBytes(column));</span><br><span class="line">        <span class="type">Scan</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>(get);</span><br><span class="line">        scanner.readVersions(versions);</span><br><span class="line">        <span class="type">ResultScanner</span> <span class="variable">rsScanner</span> <span class="operator">=</span> table.getScanner(scanner);</span><br><span class="line">        <span class="keyword">for</span> (Result result : rsScanner) &#123;</span><br><span class="line">            <span class="keyword">final</span> List&lt;Cell&gt; list = result.listCells();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">final</span> Cell kv : list) &#123;</span><br><span class="line">                System.out.println(Bytes.toStringBinary(kv.getValueArray()) + <span class="string">&quot;\t&quot;</span></span><br><span class="line">                        + kv.getTimestamp()); <span class="comment">// mid + time</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rsScanner.close();</span><br><span class="line">        <span class="type">long</span> <span class="variable">en2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;Total Time: &quot;</span> + (en2 - st) + <span class="string">&quot; ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“åŒ…æˆå¯æ‰§è¡ŒjaråŒ…<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></p>
<ol>
<li>ç‚¹å‡»å·¥å…·æ  Files é€‰é¡¹</li>
<li>ç‚¹å‡» Project Structureï¼ˆCTRL + SHIFT + ALT + S on Windows/Linuxï¼ŒâŒ˜ + ; on Mac OS Xï¼‰</li>
<li>ç‚¹å‡» Artifacts</li>
<li>ç‚¹å‡» + å·ï¼Œé€‰æ‹©JARï¼ŒFrom Modules with dependencies</li>
<li>Main Class é€‰æ‹©ImportHBase</li>
<li>JAR files from libraries é€‰æ‹© extract to the target JAR</li>
<li>é€‰æ‹©META-INF/MANIFEST.MFçš„è·¯å¾„ï¼Œè·¯å¾„é€‰æ‹©srcå³å¯</li>
<li>ç‚¹å‡»OKå®Œæˆé…ç½®</li>
<li>ç‚¹å‡»å·¥å…·æ  Build é€‰é¡¹</li>
<li>ç‚¹å‡»Build Artifact</li>
<li>ç‚¹å‡» Build ç­‰å¾…ç¼–è¯‘</li>
</ol>
<p>å°†ç”Ÿæˆçš„jaråŒ…å¤åˆ¶åˆ°<code>/usr/local/bigdatacase/hbase</code>ç›®å½•</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /usr/local/bigdatacase/hbase</span><br><span class="line"><span class="built_in">cp</span> ImportHBase.jar /usr/local/bigdatacase/hbase</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨HDFSã€ZooKeeperå’ŒHBase</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh</span><br><span class="line">zkServer.sh start</span><br><span class="line">start-hbase.sh</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨HBase Shell</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbase shell</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨æˆåŠŸåï¼Œè¿›å…¥&quot;hbase&gt;&quot;å‘½ä»¤æç¤ºç¬¦çŠ¶æ€</p>
<p>åˆ›å»º<code>user_action</code>è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hbase:001:0&gt; create &#x27;user_action&#x27;, &#123; NAME =&gt; &#x27;f1&#x27;, VERSIONS =&gt; 5&#125;</span><br><span class="line">Created table user_action</span><br><span class="line">Took 1.5141 seconds                                                                                                                     </span><br><span class="line">=&gt; Hbase::Table - user_action</span><br></pre></td></tr></table></figure>
<p>ç¡®ä¿<code>user_action</code>è¡¨ä¸ºç©º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hbase:001:0&gt; truncate &#x27;user_action&#x27;</span><br><span class="line">Truncating &#x27;user_action&#x27; table (it may take a while):</span><br><span class="line">Disabling table...</span><br><span class="line">Truncating table...</span><br><span class="line">Took 2.9350 seconds</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡hadoop jarå‘½ä»¤è¿è¡Œä¸Šé¢çš„Javaç¨‹åº</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar /usr/local/bigdatacase/hbase/ImportHBase ImportHBase /usr/local/bigdatacase/dataset/user_action.output</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯æ¼«é•¿çš„ç­‰å¾…æ—¶é—´ï¼ˆç›¸è¾ƒäºä¸Šé¢çš„Hiveå¯¼å…¥MySQLï¼Œå·²ç»æ˜¯éå¸¸éå¸¸å¿«äº†ï¼‰</p>
<p>å¯¼å…¥å®Œæˆä»¥ååœ¨HBase Shellçª—å£ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥è¯¢æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">hbase:001:0&gt; scan &#x27;user_action&#x27;,&#123;LIMIT=&gt;10&#125; </span><br><span class="line">ROW                                                                   COLUMN+CELL                                                                                                                                                                                                  </span><br><span class="line"> 1                                                                    column=f1:behavior_type, timestamp=2024-06-16T04:51:32.554, value=1                                                                                                                                          </span><br><span class="line"> 1                                                                    column=f1:date, timestamp=2024-06-16T04:51:32.554, value=2014-12-08                                                                                                                                          </span><br><span class="line"> 1                                                                    column=f1:item_category, timestamp=2024-06-16T04:51:32.554, value=4076                                                                                                                                       </span><br><span class="line"> 1                                                                    column=f1:item_id, timestamp=2024-06-16T04:51:32.554, value=285259775                                                                                                                                        </span><br><span class="line"> 1                                                                    column=f1:province, timestamp=2024-06-16T04:51:32.554, value=\xE6\xB9\x96\xE5\x8D\x97                                                                                                                        </span><br><span class="line"> 1                                                                    column=f1:uid, timestamp=2024-06-16T04:51:32.554, value=10001082                                                                                                                                             </span><br><span class="line"> 10                                                                   column=f1:behavior_type, timestamp=2024-06-16T04:51:32.573, value=1                                                                                                                                          </span><br><span class="line"> 10                                                                   column=f1:date, timestamp=2024-06-16T04:51:32.573, value=2014-12-12                                                                                                                                          </span><br><span class="line"> 10                                                                   column=f1:item_category, timestamp=2024-06-16T04:51:32.573, value=10894                                                                                                                                      </span><br><span class="line"> 10                                                                   column=f1:item_id, timestamp=2024-06-16T04:51:32.573, value=323339743                                                                                                                                        </span><br><span class="line"> 10                                                                   column=f1:province, timestamp=2024-06-16T04:51:32.573, value=\xE5\xAE\x81\xE5\xA4\x8F                                                                                                                        </span><br><span class="line"> 10                                                                   column=f1:uid, timestamp=2024-06-16T04:51:32.573, value=10001082                                                                                                                                             </span><br><span class="line"> 100                                                                  column=f1:behavior_type, timestamp=2024-06-16T04:51:32.709, value=1                                                                                                                                          </span><br><span class="line"> 100                                                                  column=f1:date, timestamp=2024-06-16T04:51:32.709, value=2014-12-02                                                                                                                                          </span><br><span class="line"> 100                                                                  column=f1:item_category, timestamp=2024-06-16T04:51:32.709, value=10576                                                                                                                                      </span><br><span class="line"> 100                                                                  column=f1:item_id, timestamp=2024-06-16T04:51:32.709, value=275221686                                                                                                                                        </span><br><span class="line"> 100                                                                  column=f1:province, timestamp=2024-06-16T04:51:32.709, value=\xE6\xB1\x9F\xE8\x8B\x8F                                                                                                                        </span><br><span class="line"> 100                                                                  column=f1:uid, timestamp=2024-06-16T04:51:32.709, value=10001082                                                                                                                                             </span><br><span class="line"> 1000                                                                 column=f1:behavior_type, timestamp=2024-06-16T04:51:33.352, value=1                                                                                                                                          </span><br><span class="line"> 1000                                                                 column=f1:date, timestamp=2024-06-16T04:51:33.352, value=2014-12-02                                                                                                                                          </span><br><span class="line"> 1000                                                                 column=f1:item_category, timestamp=2024-06-16T04:51:33.352, value=3381                                                                                                                                       </span><br><span class="line"> 1000                                                                 column=f1:item_id, timestamp=2024-06-16T04:51:33.352, value=168463559                                                                                                                                        </span><br><span class="line"> 1000                                                                 column=f1:province, timestamp=2024-06-16T04:51:33.352, value=\xE5\x86\x85\xE8\x92\x99\xE5\x8F\xA4                                                                                                            </span><br><span class="line"> 1000                                                                 column=f1:uid, timestamp=2024-06-16T04:51:33.352, value=100068031                                                                                                                                            </span><br><span class="line"> 10000                                                                column=f1:behavior_type, timestamp=2024-06-16T04:51:35.031, value=1                                                                                                                                          </span><br><span class="line"> 10000                                                                column=f1:date, timestamp=2024-06-16T04:51:35.031, value=2014-12-05                                                                                                                                          </span><br><span class="line"> 10000                                                                column=f1:item_category, timestamp=2024-06-16T04:51:35.031, value=12488                                                                                                                                      </span><br><span class="line"> 10000                                                                column=f1:item_id, timestamp=2024-06-16T04:51:35.031, value=45571867                                                                                                                                         </span><br><span class="line"> 10000                                                                column=f1:province, timestamp=2024-06-16T04:51:35.031, value=\xE8\xB4\xB5\xE5\xB7\x9E                                                                                                                        </span><br><span class="line"> 10000                                                                column=f1:uid, timestamp=2024-06-16T04:51:35.031, value=100198255                                                                                                                                            </span><br><span class="line"> 100000                                                               column=f1:behavior_type, timestamp=2024-06-16T04:51:46.061, value=1                                                                                                                                          </span><br><span class="line"> 100000                                                               column=f1:date, timestamp=2024-06-16T04:51:46.061, value=2014-11-29                                                                                                                                          </span><br><span class="line"> 100000                                                               column=f1:item_category, timestamp=2024-06-16T04:51:46.061, value=6580                                                                                                                                       </span><br><span class="line"> 100000                                                               column=f1:item_id, timestamp=2024-06-16T04:51:46.061, value=78973192                                                                                                                                         </span><br><span class="line"> 100000                                                               column=f1:province, timestamp=2024-06-16T04:51:46.061, value=\xE5\xB1\xB1\xE4\xB8\x9C                                                                                                                        </span><br><span class="line"> 100000                                                               column=f1:uid, timestamp=2024-06-16T04:51:46.061, value=101480065                                                                                                                                            </span><br><span class="line"> 1000000                                                              column=f1:behavior_type, timestamp=2024-06-16T04:53:21.091, value=1                                                                                                                                          </span><br><span class="line"> 1000000                                                              column=f1:date, timestamp=2024-06-16T04:53:21.091, value=2014-11-29                                                                                                                                          </span><br><span class="line"> 1000000                                                              column=f1:item_category, timestamp=2024-06-16T04:53:21.091, value=10961                                                                                                                                      </span><br><span class="line"> 1000000                                                              column=f1:item_id, timestamp=2024-06-16T04:53:21.091, value=88763784                                                                                                                                         </span><br><span class="line"> 1000000                                                              column=f1:province, timestamp=2024-06-16T04:53:21.091, value=\xE5\xB1\xB1\xE8\xA5\xBF                                                                                                                        </span><br><span class="line"> 1000000                                                              column=f1:uid, timestamp=2024-06-16T04:53:21.091, value=111256954                                                                                                                                            </span><br><span class="line"> 10000000                                                             column=f1:behavior_type, timestamp=2024-06-16T05:09:10.864, value=1                                                                                                                                          </span><br><span class="line"> 10000000                                                             column=f1:date, timestamp=2024-06-16T05:09:10.864, value=2014-11-27                                                                                                                                          </span><br><span class="line"> 10000000                                                             column=f1:item_category, timestamp=2024-06-16T05:09:10.864, value=1854                                                                                                                                       </span><br><span class="line"> 10000000                                                             column=f1:item_id, timestamp=2024-06-16T05:09:10.864, value=87168683                                                                                                                                         </span><br><span class="line"> 10000000                                                             column=f1:province, timestamp=2024-06-16T05:09:10.864, value=\xE6\xB9\x96\xE5\x8D\x97                                                                                                                        </span><br><span class="line"> 10000000                                                             column=f1:uid, timestamp=2024-06-16T05:09:10.864, value=123265349                                                                                                                                            </span><br><span class="line"> 10000001                                                             column=f1:behavior_type, timestamp=2024-06-16T05:09:10.864, value=1                                                                                                                                          </span><br><span class="line"> 10000001                                                             column=f1:date, timestamp=2024-06-16T05:09:10.864, value=2014-11-18                                                                                                                                          </span><br><span class="line"> 10000001                                                             column=f1:item_category, timestamp=2024-06-16T05:09:10.864, value=13712                                                                                                                                      </span><br><span class="line"> 10000001                                                             column=f1:item_id, timestamp=2024-06-16T05:09:10.864, value=125559152                                                                                                                                        </span><br><span class="line"> 10000001                                                             column=f1:province, timestamp=2024-06-16T05:09:10.864, value=\xE6\xB9\x96\xE5\x8C\x97                                                                                                                        </span><br><span class="line"> 10000001                                                             column=f1:uid, timestamp=2024-06-16T05:09:10.864, value=123265349                                                                                                                                            </span><br><span class="line"> 10000002                                                             column=f1:behavior_type, timestamp=2024-06-16T05:09:10.864, value=1                                                                                                                                          </span><br><span class="line"> 10000002                                                             column=f1:date, timestamp=2024-06-16T05:09:10.864, value=2014-12-18                                                                                                                                          </span><br><span class="line"> 10000002                                                             column=f1:item_category, timestamp=2024-06-16T05:09:10.864, value=14079                                                                                                                                      </span><br><span class="line"> 10000002                                                             column=f1:item_id, timestamp=2024-06-16T05:09:10.864, value=222706509                                                                                                                                        </span><br><span class="line"> 10000002                                                             column=f1:province, timestamp=2024-06-16T05:09:10.864, value=\xE5\x86\x85\xE8\x92\x99\xE5\x8F\xA4                                                                                                            </span><br><span class="line"> 10000002                                                             column=f1:uid, timestamp=2024-06-16T05:09:10.864, value=123265349</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ²¡å•¦ï¼Œåˆ«é—®ä¸ºä»€ä¹ˆæ²¡å†™å®Œï¼Œå› ä¸ºæ•°æ®æ²¡å¯¼å®Œå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š</p>
<p>ä¸æ„§æ˜¯å¤§æ•°æ®</p>
</blockquote>
<p>åœ¨è¿™é‡Œæ”¾ä¸€åªå°çŒ«ï¼Œå­¦ç´¯äº†å°±æ‘¸æ‘¸å®ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ ï¼¿ï¼¿</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ï¼ï¼ã€€ã€€ãƒ•</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€| ã€€_ã€€ _ l</span><br><span class="line">ã€€ ã€€ã€€ã€€ï¼` ãƒŸï¼¿xãƒ</span><br><span class="line">ã€€ã€€ ã€€ /ã€€ã€€ã€€ ã€€ |</span><br><span class="line">ã€€ã€€ã€€ /ã€€ ãƒ½ã€€ã€€ ï¾‰</span><br><span class="line">ã€€ ã€€ â”‚ã€€ã€€|ã€€|ã€€|</span><br><span class="line">ã€€ï¼ï¿£|ã€€ã€€ |ã€€|ã€€|</span><br><span class="line">ã€€| (ï¿£ãƒ½ï¼¿_ãƒ½_)__)</span><br><span class="line">ã€€ï¼¼äºŒã¤</span><br></pre></td></tr></table></figure>
<hr class="footnotes-sep" />
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/installation-guide.html#-aa9dmj_178">Install IntelliJ IDEA</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/eclipse/eclipse/downloads/drops4/R-4.23-202203080310/eclipse-SDK-4.23-linux-gtk-x86_64.tar.gz">Eclipse é˜¿é‡Œé•œåƒç«™</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/working-with-module-dependencies.html#add-a-new-dependency">Add a new dependency</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/working-with-artifacts.html#configure_artifact">Deployment/Artifacts</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    èµèµ
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.jpg" alt="Jccc å¾®ä¿¡">
        <span>å¾®ä¿¡</span>
      </div>
      <div>
        <img src="/images/alipay.jpg" alt="Jccc æ”¯ä»˜å®">
        <span>æ”¯ä»˜å®</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Jccc
  </li>
  <li class="post-copyright-link">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="https://jccc-l.github.io/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-6%E2%80%94%E2%80%94%E5%AE%9E%E9%AA%8C%E6%A1%88%E4%BE%8B%EF%BC%9A%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ">https://jccc-l.github.io/2024/06/16/å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—-No-6â€”â€”å®éªŒæ¡ˆä¾‹ï¼šç½‘ç«™ç”¨æˆ·è¡Œä¸ºåˆ†æ/</a>
  </li>
  <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
              <a href="/tags/Big-Data/" rel="tag"><i class="fa fa-tag"></i> Big Data</a>
              <a href="/tags/Hadoop/" rel="tag"><i class="fa fa-tag"></i> Hadoop</a>
              <a href="/tags/ZooKeeper/" rel="tag"><i class="fa fa-tag"></i> ZooKeeper</a>
              <a href="/tags/HBase/" rel="tag"><i class="fa fa-tag"></i> HBase</a>
              <a href="/tags/R/" rel="tag"><i class="fa fa-tag"></i> R</a>
              <a href="/tags/Hive/" rel="tag"><i class="fa fa-tag"></i> Hive</a>
              <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/06/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%9E%E9%AA%8C%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97-No-5%E2%80%94%E2%80%94R%E8%AF%AD%E8%A8%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%9A%84%E5%AE%89%E8%A3%85/" rel="prev" title="å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.5â€”â€”Rè¯­è¨€å’Œè½¯ä»¶åŒ…çš„å®‰è£…">
                  <i class="fa fa-angle-left"></i> å¤§æ•°æ®å®éªŒè¸©å‘æŒ‡å—_No.5â€”â€”Rè¯­è¨€å’Œè½¯ä»¶åŒ…çš„å®‰è£…
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/06/17/Ubuntu%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEWaydroid/" rel="next" title="Ubuntuå®‰è£…é…ç½®Waydroid">
                  Ubuntuå®‰è£…é…ç½®Waydroid <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"><span id="copyright"> è·¯è¿‡çš„å³æ˜¯é£æ™¯. All rights reserved. Non-commercial use allowed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>.</span></span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">124k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:53</span>
  </span>
</div><footer>
    <div>
        <!-- æ—¶é—´ç»Ÿè®¡éƒ¨åˆ† -->
        <span id="timeDate">è½½å…¥å¤©æ•°...</span>
        <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
        <script>
            var now = new Date();
            function createtime() {
                var grt = new Date("05/04/2023 00:00:00");
                now.setTime(now.getTime() + 250);
                days = (now - grt) / 1000 / 60 / 60 / 24; 
                dnum = Math.floor(days);
                hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum); 
                hnum = Math.floor(hours);
                if(String(hnum).length == 1) {hnum = "0" + hnum;}
                minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
                mnum = Math.floor(minutes);
                if(String(mnum).length == 1) {mnum = "0" + mnum;}
                seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
                snum = Math.round(seconds);
                if(String(snum).length == 1) {snum = "0" + snum;}
                document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + dnum + " å¤© ";
                document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
            }
            setInterval("createtime()", 250);
        </script>
        <!-- ç‰ˆæƒä¿¡æ¯ä¸è”ç³»ä¿¡æ¯éƒ¨åˆ† -->
<!--
		&copy; 2023-<span id="currentYearPlaceholder">YYYY</span>
		<span id="copyright"> è·¯è¿‡çš„å³æ˜¯é£æ™¯. All rights reserved. Non-commercial use allowed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>.</span>
-->
<!--
		<span id="disclaimer" style="text-align: left;">disclaimer: <br>content provided for reference only. <br>accuracy, completeness, suitability not guaranteed. <br>not liable for any loss or damage.</span>
-->

		<br>
		<!--è”ç³»ä¿¡æ¯éƒ¨åˆ†-->
		<span id="Contact">Contact Me: <a href="mailto:1216550215Jc@gmail.com">GMail</a> | Address: Guangdong, China</span>
		<script>
			// ä½¿ç”¨JavaScriptè·å–å½“å‰å¹´ä»½å¹¶æ›´æ–°åˆ°é¡µé¢ä¸Š
			document.getElementById('currentYearPlaceholder').innerText = new Date().getFullYear();
		</script>
    </div>
</footer>


    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">



</body>
</html>
